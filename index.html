<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>JAR Runner in Browser</title>
    <script src="https://cjrtnc.leaningtech.com/3.0/cj3loader.js"></script>
</head>
<body style="font-family: sans-serif; padding: 20px;">

    <h2>ブラウザでJAR実行 (CheerpJ)</h2>
    
    <p>実行したいJARファイルを選択してください（Swing/AWT対応）:</p>
    <input type="file" id="jarInput" accept=".jar">
    
    <div id="console" style="background: #eee; padding: 10px; margin-top: 10px; height: 100px; overflow: auto; border: 1px solid #ccc;">
        コンソールログ...
    </div>

    <div id="jar-container" style="margin-top: 20px; border: 2px solid #333; width: 640px; height: 480px;"></div>

    <script>
        // CheerpJの初期化
        cheerpjInit();

        document.getElementById('jarInput').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const consoleDiv = document.getElementById('console');
            consoleDiv.innerHTML += `<div>Loading ${file.name}...</div>`;

            // 仮想ファイルシステムにファイルを書き込む
            const arrayBuffer = await file.arrayBuffer();
            const fileName = `/files/${file.name}`;
            
            // CheerpJの仮想FSに保存
            cheerpjCreateFile(fileName, new Uint8Array(arrayBuffer));

            consoleDiv.innerHTML += `<div>Executing...</div>`;

            // JARを実行 (GUIを表示)
            // cjDomを使ってHTML要素内に表示させることも可能ですが、デフォルトではオーバーレイ表示されます
            cheerpjRunJar(fileName);
        });
    </script>
</body>
</html>
